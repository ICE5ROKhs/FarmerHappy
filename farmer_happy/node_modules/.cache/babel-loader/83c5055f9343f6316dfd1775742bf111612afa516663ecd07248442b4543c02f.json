{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, normalizeClass as _normalizeClass, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelSelect as _vModelSelect, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"auth-container\"\n};\nconst _hoisted_2 = {\n  class: \"auth-card\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"form-error\"\n};\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"form-error\"\n};\nconst _hoisted_7 = {\n  class: \"form-group\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"form-error\"\n};\nconst _hoisted_9 = {\n  class: \"form-group\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"form-error\"\n};\nconst _hoisted_11 = [\"disabled\"];\nconst _hoisted_12 = {\n  class: \"auth-switch\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[12] || (_cache[12] = _createElementVNode(\"h1\", {\n    class: \"auth-title\"\n  }, \"注册农乐平台\", -1 /* CACHED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers((...args) => $setup.handleSubmit && $setup.handleSubmit(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"手机号\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.form.phone = $event),\n    type: \"tel\",\n    class: _normalizeClass([\"form-input\", {\n      'error': $setup.errors.phone\n    }]),\n    placeholder: \"请输入手机号\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.phone]]), $setup.errors.phone ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _toDisplayString($setup.errors.phone), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_5, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"密码\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.form.password = $event),\n    type: \"password\",\n    class: _normalizeClass([\"form-input\", {\n      'error': $setup.errors.password\n    }]),\n    placeholder: \"请输入密码（8-32位，包含大小写字母和数字）\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.password]]), $setup.errors.password ? (_openBlock(), _createElementBlock(\"span\", _hoisted_6, _toDisplayString($setup.errors.password), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_7, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"昵称\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.form.nickname = $event),\n    type: \"text\",\n    class: _normalizeClass([\"form-input\", {\n      'error': $setup.errors.nickname\n    }]),\n    placeholder: \"请输入昵称\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.nickname]]), $setup.errors.nickname ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString($setup.errors.nickname), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_9, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"用户类型\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.form.user_type = $event),\n    class: _normalizeClass([\"form-input\", {\n      'error': $setup.errors.user_type\n    }])\n  }, [...(_cache[8] || (_cache[8] = [_createStaticVNode(\"<option value=\\\"\\\" data-v-7bf3755a>请选择用户类型</option><option value=\\\"farmer\\\" data-v-7bf3755a>农户</option><option value=\\\"buyer\\\" data-v-7bf3755a>买家</option><option value=\\\"expert\\\" data-v-7bf3755a>技术专家</option><option value=\\\"bank\\\" data-v-7bf3755a>银行</option><option value=\\\"admin\\\" data-v-7bf3755a>管理员</option>\", 6)]))], 2 /* CLASS */), [[_vModelSelect, $setup.form.user_type]]), $setup.errors.user_type ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, _toDisplayString($setup.errors.user_type), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary\",\n    disabled: $setup.loading\n  }, _toDisplayString($setup.loading ? '注册中...' : '注册'), 9 /* TEXT, PROPS */, _hoisted_11), _createElementVNode(\"div\", _hoisted_12, [_cache[11] || (_cache[11] = _createTextVNode(\" 已有账号？ \", -1 /* CACHED */)), _createVNode(_component_router_link, {\n    to: \"/login\"\n  }, {\n    default: _withCtx(() => [...(_cache[10] || (_cache[10] = [_createTextVNode(\"立即登录\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  })])], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","args","$setup","handleSubmit","_hoisted_3","form","phone","$event","type","_normalizeClass","errors","placeholder","_hoisted_4","_toDisplayString","_hoisted_5","password","_hoisted_6","_hoisted_7","nickname","_hoisted_8","_hoisted_9","user_type","_hoisted_10","disabled","loading","_hoisted_11","_hoisted_12","_createVNode","_component_router_link","to"],"sources":["D:\\STUDY\\FarmerHappy\\farmer_happy\\src\\components\\Register.vue"],"sourcesContent":["<template>\r\n  <div class=\"auth-container\">\r\n    <div class=\"auth-card\">\r\n      <h1 class=\"auth-title\">注册农乐平台</h1>\r\n      <form @submit.prevent=\"handleSubmit\">\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">手机号</label>\r\n          <input\r\n            v-model=\"form.phone\"\r\n            type=\"tel\"\r\n            class=\"form-input\"\r\n            :class=\"{ 'error': errors.phone }\"\r\n            placeholder=\"请输入手机号\"\r\n          />\r\n          <span v-if=\"errors.phone\" class=\"form-error\">{{ errors.phone }}</span>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">密码</label>\r\n          <input\r\n            v-model=\"form.password\"\r\n            type=\"password\"\r\n            class=\"form-input\"\r\n            :class=\"{ 'error': errors.password }\"\r\n            placeholder=\"请输入密码（8-32位，包含大小写字母和数字）\"\r\n          />\r\n          <span v-if=\"errors.password\" class=\"form-error\">{{ errors.password }}</span>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">昵称</label>\r\n          <input\r\n            v-model=\"form.nickname\"\r\n            type=\"text\"\r\n            class=\"form-input\"\r\n            :class=\"{ 'error': errors.nickname }\"\r\n            placeholder=\"请输入昵称\"\r\n          />\r\n          <span v-if=\"errors.nickname\" class=\"form-error\">{{ errors.nickname }}</span>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">用户类型</label>\r\n          <select\r\n            v-model=\"form.user_type\"\r\n            class=\"form-input\"\r\n            :class=\"{ 'error': errors.user_type }\"\r\n          >\r\n            <option value=\"\">请选择用户类型</option>\r\n            <option value=\"farmer\">农户</option>\r\n            <option value=\"buyer\">买家</option>\r\n            <option value=\"expert\">技术专家</option>\r\n            <option value=\"bank\">银行</option>\r\n            <option value=\"admin\">管理员</option>\r\n          </select>\r\n          <span v-if=\"errors.user_type\" class=\"form-error\">{{ errors.user_type }}</span>\r\n        </div>\r\n\r\n        <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"loading\">\r\n          {{ loading ? '注册中...' : '注册' }}\r\n        </button>\r\n\r\n        <div class=\"auth-switch\">\r\n          已有账号？\r\n          <router-link to=\"/login\">立即登录</router-link>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { authService } from '../api/auth';\r\n\r\nexport default {\r\n  name: 'Register',\r\n  setup() {\r\n    const router = useRouter();\r\n    const loading = ref(false);\r\n    const form = reactive({\r\n      phone: '',\r\n      password: '',\r\n      nickname: '',\r\n      user_type: ''\r\n    });\r\n    const errors = reactive({\r\n      phone: '',\r\n      password: '',\r\n      nickname: '',\r\n      user_type: ''\r\n    });\r\n\r\n    const validateForm = () => {\r\n      let isValid = true;\r\n      // Reset errors\r\n      Object.keys(errors).forEach(key => errors[key] = '');\r\n\r\n      // Phone validation\r\n      if (!form.phone) {\r\n        errors.phone = '请输入手机号';\r\n        isValid = false;\r\n      } else if (!/^1[3-9]\\d{9}$/.test(form.phone)) {\r\n        errors.phone = '请输入有效的手机号';\r\n        isValid = false;\r\n      }\r\n\r\n      // Password validation\r\n      if (!form.password) {\r\n        errors.password = '请输入密码';\r\n        isValid = false;\r\n      } else if (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).{8,32}$/.test(form.password)) {\r\n        errors.password = '密码必须包含大小写字母和数字，长度8-32位';\r\n        isValid = false;\r\n      }\r\n\r\n      // Nickname validation (optional)\r\n      if (form.nickname && (form.nickname.length < 1 || form.nickname.length > 30)) {\r\n        errors.nickname = '昵称长度应在1-30个字符之间';\r\n        isValid = false;\r\n      }\r\n\r\n      // User type validation\r\n      if (!form.user_type) {\r\n        errors.user_type = '请选择用户类型';\r\n        isValid = false;\r\n      }\r\n\r\n      return isValid;\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n      if (!validateForm()) return;\r\n\r\n      loading.value = true;\r\n      try {\r\n        await authService.register(form);\r\n        router.push('/login');\r\n      } catch (error) {\r\n        if (error.message === 'Phone already exists') {\r\n          errors.phone = '该手机号已被注册';\r\n        } else {\r\n          errors.password = '注册失败，请稍后重试';\r\n        }\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    return {\r\n      form,\r\n      errors,\r\n      loading,\r\n      handleSubmit\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import '../assets/styles/theme.css';\r\n\r\nselect.form-input {\r\n  appearance: none;\r\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23A0AEC0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n  background-repeat: no-repeat;\r\n  background-position: right 0.75rem center;\r\n  background-size: 16px;\r\n  padding-right: 2.5rem;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}