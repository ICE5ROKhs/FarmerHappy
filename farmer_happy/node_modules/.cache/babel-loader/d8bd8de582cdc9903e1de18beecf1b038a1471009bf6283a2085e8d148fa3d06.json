{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, normalizeClass as _normalizeClass, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"auth-container\"\n};\nconst _hoisted_2 = {\n  class: \"auth-card\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"form-error\"\n};\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"form-error\"\n};\nconst _hoisted_7 = [\"disabled\"];\nconst _hoisted_8 = {\n  class: \"auth-switch\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[7] || (_cache[7] = _createElementVNode(\"h1\", {\n    class: \"auth-title\"\n  }, \"欢迎登录农乐平台\", -1 /* CACHED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers((...args) => $setup.handleSubmit && $setup.handleSubmit(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"手机号\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.form.phone = $event),\n    type: \"tel\",\n    class: _normalizeClass([\"form-input\", {\n      'error': $setup.errors.phone\n    }]),\n    placeholder: \"请输入手机号\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.phone]]), $setup.errors.phone ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _toDisplayString($setup.errors.phone), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_5, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"密码\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.form.password = $event),\n    type: \"password\",\n    class: _normalizeClass([\"form-input\", {\n      'error': $setup.errors.password\n    }]),\n    placeholder: \"请输入密码\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.password]]), $setup.errors.password ? (_openBlock(), _createElementBlock(\"span\", _hoisted_6, _toDisplayString($setup.errors.password), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary\",\n    disabled: $setup.loading\n  }, _toDisplayString($setup.loading ? '登录中...' : '登录'), 9 /* TEXT, PROPS */, _hoisted_7), _createElementVNode(\"div\", _hoisted_8, [_cache[6] || (_cache[6] = _createTextVNode(\" 还没有账号？ \", -1 /* CACHED */)), _createVNode(_component_router_link, {\n    to: \"/register\"\n  }, {\n    default: _withCtx(() => [...(_cache[5] || (_cache[5] = [_createTextVNode(\"立即注册\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  })])], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","args","$setup","handleSubmit","_hoisted_3","form","phone","$event","type","_normalizeClass","errors","placeholder","_hoisted_4","_toDisplayString","_hoisted_5","password","_hoisted_6","disabled","loading","_hoisted_7","_hoisted_8","_createVNode","_component_router_link","to"],"sources":["D:\\STUDY\\FarmerHappy\\farmer_happy\\src\\components\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"auth-container\">\r\n    <div class=\"auth-card\">\r\n      <h1 class=\"auth-title\">欢迎登录农乐平台</h1>\r\n      <form @submit.prevent=\"handleSubmit\">\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">手机号</label>\r\n          <input\r\n            v-model=\"form.phone\"\r\n            type=\"tel\"\r\n            class=\"form-input\"\r\n            :class=\"{ 'error': errors.phone }\"\r\n            placeholder=\"请输入手机号\"\r\n          />\r\n          <span v-if=\"errors.phone\" class=\"form-error\">{{ errors.phone }}</span>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"form-label\">密码</label>\r\n          <input\r\n            v-model=\"form.password\"\r\n            type=\"password\"\r\n            class=\"form-input\"\r\n            :class=\"{ 'error': errors.password }\"\r\n            placeholder=\"请输入密码\"\r\n          />\r\n          <span v-if=\"errors.password\" class=\"form-error\">{{ errors.password }}</span>\r\n        </div>\r\n\r\n        <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"loading\">\r\n          {{ loading ? '登录中...' : '登录' }}\r\n        </button>\r\n\r\n        <div class=\"auth-switch\">\r\n          还没有账号？\r\n          <router-link to=\"/register\">立即注册</router-link>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, onMounted, onUnmounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { authService } from '../api/auth';\r\nimport logger from '../utils/logger';\r\n\r\nexport default {\r\n  name: 'Login',\r\n  setup() {\r\n    const router = useRouter();\r\n    const loading = ref(false);\r\n    const form = reactive({\r\n      phone: '',\r\n      password: ''\r\n    });\r\n    const errors = reactive({\r\n      phone: '',\r\n      password: ''\r\n    });\r\n\r\n    onMounted(() => {\r\n      logger.lifecycle('Login', 'mounted');\r\n      logger.info('LOGIN_COMPONENT', '登录页面已加载');\r\n    });\r\n\r\n    onUnmounted(() => {\r\n      logger.lifecycle('Login', 'unmounted');\r\n    });\r\n\r\n    const validateForm = () => {\r\n      logger.debug('LOGIN_COMPONENT', '开始验证登录表单');\r\n      let isValid = true;\r\n      errors.phone = '';\r\n      errors.password = '';\r\n\r\n      if (!form.phone) {\r\n        errors.phone = '请输入手机号';\r\n        isValid = false;\r\n      } else if (!/^1[3-9]\\d{9}$/.test(form.phone)) {\r\n        errors.phone = '请输入有效的手机号';\r\n        isValid = false;\r\n      }\r\n\r\n      if (!form.password) {\r\n        errors.password = '请输入密码';\r\n        isValid = false;\r\n      }\r\n\r\n      logger.validation('LoginForm', isValid, errors);\r\n      return isValid;\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n      logger.userAction('LOGIN_SUBMIT', { phone: form.phone });\r\n      \r\n      if (!validateForm()) {\r\n        logger.warn('LOGIN_COMPONENT', '表单验证失败');\r\n        return;\r\n      }\r\n\r\n      loading.value = true;\r\n      logger.info('LOGIN_COMPONENT', '开始提交登录请求', { phone: form.phone });\r\n      \r\n      try {\r\n        await authService.login(form);\r\n        logger.info('LOGIN_COMPONENT', '登录成功，准备跳转到首页');\r\n        logger.navigation('/login', '/home');\r\n        router.push('/home');\r\n      } catch (error) {\r\n        logger.error('LOGIN_COMPONENT', '登录失败', {\r\n          phone: form.phone,\r\n          errorMessage: error.message || error\r\n        }, error);\r\n        \r\n        if (error.message === 'Invalid credentials') {\r\n          errors.password = '手机号或密码错误';\r\n          logger.warn('LOGIN_COMPONENT', '登录凭据无效');\r\n        } else {\r\n          errors.password = '登录失败，请稍后重试';\r\n          logger.error('LOGIN_COMPONENT', '登录出现未知错误');\r\n        }\r\n      } finally {\r\n        loading.value = false;\r\n        logger.debug('LOGIN_COMPONENT', '登录请求处理完成');\r\n      }\r\n    };\r\n\r\n    return {\r\n      form,\r\n      errors,\r\n      loading,\r\n      handleSubmit\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import '../assets/styles/theme.css';\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAgB;;EACpBA,KAAK,EAAC;AAAW;;EAGbA,KAAK,EAAC;AAAY;;;EASKA,KAAK,EAAC;;;EAG7BA,KAAK,EAAC;AAAY;;;EASQA,KAAK,EAAC;;;;EAOhCA,KAAK,EAAC;AAAa;;;uBAhC9BC,mBAAA,CAsCM,OAtCNC,UAsCM,GArCJC,mBAAA,CAoCM,OApCNC,UAoCM,G,0BAnCJD,mBAAA,CAAoC;IAAhCH,KAAK,EAAC;EAAY,GAAC,UAAQ,qBAC/BG,mBAAA,CAiCO;IAjCAE,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,KAAAC,IAAA,KAAUC,MAAA,CAAAC,YAAA,IAAAD,MAAA,CAAAC,YAAA,IAAAF,IAAA,CAAY;MACjCL,mBAAA,CAUM,OAVNQ,UAUM,G,0BATJR,mBAAA,CAAqC;IAA9BH,KAAK,EAAC;EAAY,GAAC,KAAG,qB,gBAC7BG,mBAAA,CAME;+DALSM,MAAA,CAAAG,IAAI,CAACC,KAAK,GAAAC,MAAA;IACnBC,IAAI,EAAC,KAAK;IACVf,KAAK,EAAAgB,eAAA,EAAC,YAAY;MAAA,SACCP,MAAA,CAAAQ,MAAM,CAACJ;IAAK;IAC/BK,WAAW,EAAC;0CAJHT,MAAA,CAAAG,IAAI,CAACC,KAAK,E,GAMTJ,MAAA,CAAAQ,MAAM,CAACJ,KAAK,I,cAAxBZ,mBAAA,CAAsE,QAAtEkB,UAAsE,EAAAC,gBAAA,CAAtBX,MAAA,CAAAQ,MAAM,CAACJ,KAAK,oB,qCAG9DV,mBAAA,CAUM,OAVNkB,UAUM,G,0BATJlB,mBAAA,CAAoC;IAA7BH,KAAK,EAAC;EAAY,GAAC,IAAE,qB,gBAC5BG,mBAAA,CAME;+DALSM,MAAA,CAAAG,IAAI,CAACU,QAAQ,GAAAR,MAAA;IACtBC,IAAI,EAAC,UAAU;IACff,KAAK,EAAAgB,eAAA,EAAC,YAAY;MAAA,SACCP,MAAA,CAAAQ,MAAM,CAACK;IAAQ;IAClCJ,WAAW,EAAC;0CAJHT,MAAA,CAAAG,IAAI,CAACU,QAAQ,E,GAMZb,MAAA,CAAAQ,MAAM,CAACK,QAAQ,I,cAA3BrB,mBAAA,CAA4E,QAA5EsB,UAA4E,EAAAH,gBAAA,CAAzBX,MAAA,CAAAQ,MAAM,CAACK,QAAQ,oB,qCAGpEnB,mBAAA,CAES;IAFDY,IAAI,EAAC,QAAQ;IAACf,KAAK,EAAC,iBAAiB;IAAEwB,QAAQ,EAAEf,MAAA,CAAAgB;sBACpDhB,MAAA,CAAAgB,OAAO,0CAAAC,UAAA,GAGZvB,mBAAA,CAGM,OAHNwB,UAGM,G,2CAHmB,UAEvB,qBAAAC,YAAA,CAA8CC,sBAAA;IAAjCC,EAAE,EAAC;EAAW;sBAAC,MAAI,KAAAxB,MAAA,QAAAA,MAAA,O,iBAAJ,MAAI,mB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}